## Условие задания:

Музыкальный сервис Botify готовит рекомендации треков для пользователей. Сервис растет и развивается,
а вот рекомендательная система в его основе пока далека от совершенства. В качестве бейзлайна мы используем collaborative filtering подход.
Для улучшения качества рекомендаций предлагаем обучить модель, которая победит текущий бейзлайн по метрике NDCG.
Метрика, которую нужно оптимизировать - NDCG.

## Этапы решения:
1) Изначально я использовала базовый LightFM, с
параметрами {‘loss’ : ‘warp’}, у меня не поднимался скор
выше скора рандомайзера, что очевидно очень плохо и
логично одновременно.
2) Решила потьюнить гиперпараметры через частичное
обучение и optuna. Для этого смотрела на метрики типа
precision@k (передавала туда val часть датасета), чтобы
выбрать лучший набор гиперпараметров. Сохранив пару
результирующих файлов с лучшими и худшими
гипепараметрами (с самой высокой и самой низкой
метрикой), решила отправить решения на allcups, в итоге
всё равно получила плохой скор (0.6), так еще и скоры
этих двух файлов были практически одинаковы. После
этаких манипуляций с кодом я поняла, что я точно что-то
делаю не так. В итоге я просто неправильно передавала в
predict тестовые данные.
3) Я исправила багу с тестовыми данными и получила скор
около 0.82. Далее добавила веса (score) из тренировочного
набора данных в обучение (в sample_weight) модели и
получила скор 0.91.
4) Поскольку до того, как исправить багу с тестовыми
данными, я посмотрела на распределение, объём данных и
другие вещи из анализа данных, я заранее знала, что мне
нужно взять гиперпараметры с большими значениями,
типа max_sampled=[1000…5000], no_components=[90…130]
и learning_rate=0.1. Перебрав втупую гиперпараметры,
получила скор 0.94.
5) Это мой наилучший скор, но точно не наилучший
возможный, поэтому решила воспользоваться признаками
треков из tracks.json, чтобы потом запихнуть их как
item_features в обучении. В качестве признаков из этого
файла выбрала жанр песни (genre) и популярность песни
(pop). Кучу времени потратила, чтобы привести их к
нужному виду, но у меня так и не получилось вместе с
признаками треков получить скор выше чем 0.71. Мне
кажется, что проблема в подборе гиперпараметров, но я
уже не успела их дотюнить.
